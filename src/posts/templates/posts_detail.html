{% extends 'base.html' %}
{% load static %}

{% block content %}
{% if list.0 != None %}
    <a name="back" href="/posts/{{ list.0.id }}">previous post</a>
{% else %}
    <a name="back">previous post</a>
{% endif %}
<a name="postpage" href=".">back to posts</a>
{% if list.2 != None %}
    <a name="next" href="/posts/{{ list.2.id }}">next post</a>
{% else %}
    <a name="next">next post</a>
{% endif %}

<style>
    a[name="postpage"] {
        float: left;
        width:33.33333%;
        text-align:center;
    }
    a[name="back"] {
        float:left;
        width:33.33333%;
        text-align:left;
    }
    a[name="next"] {
        float:right;
        width:33.33333%;
        text-align:right;
    }
    .center {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 75%;
    }
</style>
<script>
    function stateVoted(voted, updown, id) {
        if (updown) {
            if (voted == 1)
                document.getElementById(id).src = "/media/assets/up_active.png"
            else
                document.getElementById(id).src = "/media/assets/up.png"
        }
        else {
            if (voted == -1)
                document.getElementById(id).src = "/media/assets/down_active.png"
            else
                document.getElementById(id).src = "/media/assets/down.png"
        }
    }
    function like(id) {
        window.location.href = '/posts/upvote/' + id;
        setTimeout(function() {
            window.location = '.';
            window.location.reload();
        }, 100);
    }
    function dislike(id) {
        window.location.href = '/posts/downvote/' + id;
        setTimeout(function() {
            window.location = '.';
            window.location.reload();
        }, 100);
    }
</script>
<br>
<h1>{{ obj.title }}</h1>
<div class="scores">
<span id="likes" style="padding-right:120px;"><a href="javascript:like({{obj.id}}, {{obj.upvote.count}})"><img id={{obj.id}} src="" height="auto"></a>  Likes: {{obj.upvote.count}}</span>
<span id="dilikes" style="padding-left:120px;">Dislikes: {{obj.downvote.count}}  <a href="javascript:dislike({{obj.id}}, {{obj.downvote.count}})"><img id=-{{obj.id}} src=""  height="auto"></a></span>
    <script>
        stateVoted({{voted}}, 1, {{obj.id}});
        stateVoted({{voted}}, 0, -{{obj.id}});
    </script>
</div>
<h6> - {{ obj.user }}</h6>
{% if obj.edited != obj.uploaded %}
    <p>Uploaded: {{ obj.uploaded }}  Last Edited: {{ obj.edited }} </p>
{% else %}
    <p>{{ obj.uploaded }}</p>
{% endif %}
{% if obj.user == request.user %}
    <a href="/posts/edit/{{ list.1.id }}">edit post</a> | <a href="/posts/delete/{{ list.1.id }}">delete post</a>
{% endif %}
<hr>
{% if obj.file %}
    <img src="{{ obj.file.url }}" alt="" class="center"/>
{% endif %}
<div align="justify">
    {{ obj.content|linebreaks }}
</div>
{% endblock %}
